(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const e of n)if(e.type==="childList")for(const t of e.addedNodes)t.tagName==="LINK"&&t.rel==="modulepreload"&&o(t)}).observe(document,{childList:!0,subtree:!0});function d(n){const e={};return n.integrity&&(e.integrity=n.integrity),n.referrerPolicy&&(e.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?e.credentials="include":n.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function o(n){if(n.ep)return;n.ep=!0;const e=d(n);fetch(n.href,e)}})();console.log("Doctiplay Presentation Initialized");function L(){const l=document.getElementById("main"),a=document.getElementById("indicator");l&&a&&l.addEventListener("scroll",()=>{const t=l.scrollTop,i=l.scrollHeight-l.clientHeight,s=i>0?t/i*100:0;a.style.height=s+"%"});const d=document.querySelectorAll(".reveal"),o=new IntersectionObserver(t=>{t.forEach(i=>{i.isIntersecting&&i.target.classList.add("active")})},{threshold:.1});d.forEach(t=>o.observe(t)),document.querySelectorAll("#slide-1 .reveal").forEach(t=>{t.classList.add("active")}),document.querySelectorAll('a[href^="#"]').forEach(t=>{t.addEventListener("click",i=>{const s=t.getAttribute("href"),r=document.querySelector(s);r&&l&&(i.preventDefault(),r.scrollIntoView({behavior:"smooth"}))})});const e=document.getElementById("pdf-export-btn");e&&e.addEventListener("click",()=>{document.querySelectorAll(".reveal").forEach(i=>i.classList.add("active")),setTimeout(()=>{window.print()},300)})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{L(),w()}):(L(),setTimeout(w,100));const c={fc:90,spo2:99,nibpSys:100,nibpDia:60,targetFc:90,targetSpo2:99,targetNibpSys:100,targetNibpDia:60};window.scopeAction=function(l){const a=document.querySelectorAll(".scope-toast"),o=new Date().toLocaleTimeString("fr-FR");let n="";if(l==="o2"){c.targetSpo2=98,n="O₂ administré";let e=c.spo2>95?95:c.spo2;I(".val-spo2",e,98,2e3),c.spo2=98}else l==="remplissage"?(c.targetNibpSys=110,c.targetNibpDia=70,n="Remplissage initié",x(c.nibpSys,c.nibpDia,110,70),c.nibpSys=110,c.nibpDia=70):l==="insuline"&&(c.targetFc=85,n="Insulinothérapie débutée",I(".val-fc",c.fc,85,2e3),c.fc=85);a.forEach(e=>{e.innerText=`[${o}] ${n}`,e.classList.add("show"),setTimeout(()=>e.classList.remove("show"),3e3)})};function I(l,a,d,o,n){const e=document.querySelectorAll(l);if(e.length===0)return;e.forEach(f=>{f.classList.add("pulse-anim"),setTimeout(()=>f.classList.remove("pulse-anim"),300)});const t=d-a;let i=a;const s=d>a?1:-1,r=Math.abs(Math.floor(o/(t===0?1:t)));if(t===0)return;const u=setInterval(function(){i+=s,e.forEach(f=>f.innerText=i),i==d&&clearInterval(u)},Math.max(r,50))}function x(l,a,d,o){const n=document.querySelectorAll(".val-nibp");if(n.length===0)return;n.forEach(s=>{s.classList.add("pulse-anim"),setTimeout(()=>s.classList.remove("pulse-anim"),300)});let e=l,t=a;const i=setInterval(()=>{let s=!1;e!=d&&(e+=e<d?1:-1,s=!0),t!=o&&e%2===0&&(t+=t<o?1:-1,s=!0),n.forEach(r=>r.innerText=`${e}/${t}`),s||clearInterval(i)},100)}function w(){const l=document.querySelectorAll(".live-monitor");if(l.length===0){setTimeout(w,500);return}l.forEach(o=>{const n=o.querySelector(".ecg-canvas"),e=o.querySelector(".pleth-canvas");if(!n||!e)return;function t(){const h=n.parentElement,m=e.parentElement,g=h.getBoundingClientRect(),y=m.getBoundingClientRect(),v=g.width||h.clientWidth,p=g.height||h.clientHeight,E=y.width||m.clientWidth,S=y.height||m.clientHeight;v>0&&p>0&&(n.width=v,n.height=p),E>0&&S>0&&(e.width=E,e.height=S)}t(),setTimeout(t,100),setTimeout(t,1e3),window.addEventListener("resize",t);const i=n.getContext("2d"),s=e.getContext("2d");let r=0,u=1.4;function f(){const h=n.height,m=h/2+25,g=e.height,y=g/2+15,v=14;r+v<n.width&&(i.clearRect(r,0,v,h),s.clearRect(r,0,v,g));const p=20;i.beginPath(),i.strokeStyle="#00ff00",i.lineWidth=1.5;const E=m+a((r-u)*p),S=m+a(r*p);i.moveTo(r-u,E),i.lineTo(r,S),i.stroke(),s.beginPath(),s.strokeStyle="#00ffff",s.lineWidth=1.5;const q=y+d((r-u)*p),M=y+d(r*p);s.moveTo(r-u,q),s.lineTo(r,M),s.stroke(),r+=u,r>=n.width&&(r=0,i.clearRect(0,0,u+10,h),s.clearRect(0,0,u+10,g));const b=o.querySelector(".val-fc"),T=o.querySelector(".val-spo2"),P=o.querySelector(".val-nibp");b&&b.innerText!=c.fc&&(b.innerText=c.fc),T&&T.innerText!=c.spo2&&(T.innerText=c.spo2),P&&P.innerText!=`${c.nibpSys}/${c.nibpDia}`&&(P.innerText=`${c.nibpSys}/${c.nibpDia}`),requestAnimationFrame(f)}requestAnimationFrame(f)});function a(o){const e=o%800;let t=0;return e>180&&e<210&&(t-=90*Math.sin((e-180)/30*Math.PI)),e>300&&e<450&&(t-=12*Math.sin((e-300)/150*Math.PI)),e>50&&e<150&&(t-=4*Math.sin((e-50)/100*Math.PI)),t}function d(o){const e=o%800;let t=0;return e<300?t-=Math.sin(e/300*Math.PI)*45:t-=Math.cos((e-300)/500*Math.PI/2)*45,t}}
