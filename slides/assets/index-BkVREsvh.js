(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const e of n)if(e.type==="childList")for(const t of e.addedNodes)t.tagName==="LINK"&&t.rel==="modulepreload"&&s(t)}).observe(document,{childList:!0,subtree:!0});function d(n){const e={};return n.integrity&&(e.integrity=n.integrity),n.referrerPolicy&&(e.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?e.credentials="include":n.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function s(n){if(n.ep)return;n.ep=!0;const e=d(n);fetch(n.href,e)}})();console.log("Doctiplay Presentation Initialized");function x(){const o=document.getElementById("main"),a=document.getElementById("indicator");o&&a&&o.addEventListener("scroll",()=>{const t=o.scrollTop,i=o.scrollHeight-o.clientHeight,r=i>0?t/i*100:0;a.style.height=r+"%"});const d=document.querySelectorAll(".reveal"),s=new IntersectionObserver(t=>{t.forEach(i=>{i.isIntersecting&&i.target.classList.add("active")})},{threshold:.1});d.forEach(t=>s.observe(t)),document.querySelectorAll("#slide-1 .reveal").forEach(t=>{t.classList.add("active")}),o&&window.addEventListener("keydown",t=>{const i=o.clientHeight;(t.key==="ArrowDown"||t.key==="PageDown")&&(t.preventDefault(),o.scrollBy({top:i,left:0,behavior:"smooth"})),(t.key==="ArrowUp"||t.key==="PageUp")&&(t.preventDefault(),o.scrollBy({top:-i,left:0,behavior:"smooth"}))}),document.querySelectorAll('a[href^="#"]').forEach(t=>{t.addEventListener("click",i=>{const r=t.getAttribute("href"),c=document.querySelector(r);c&&o&&(i.preventDefault(),c.scrollIntoView({behavior:"smooth"}))})});const e=document.getElementById("pdf-export-btn");e&&e.addEventListener("click",()=>{document.querySelectorAll(".reveal").forEach(i=>i.classList.add("active")),setTimeout(()=>{window.print()},300)})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{x(),L()}):(x(),setTimeout(L,100));const l={fc:90,spo2:99,nibpSys:100,nibpDia:60,targetFc:90,targetSpo2:99,targetNibpSys:100,targetNibpDia:60};window.scopeAction=function(o){const a=document.querySelectorAll(".scope-toast"),s=new Date().toLocaleTimeString("fr-FR");let n="";if(o==="o2"){l.targetSpo2=98,n="O₂ administré";let e=l.spo2>95?95:l.spo2;I(".val-spo2",e,98,2e3),l.spo2=98}else o==="remplissage"?(l.targetNibpSys=110,l.targetNibpDia=70,n="Remplissage initié",A(l.nibpSys,l.nibpDia,110,70),l.nibpSys=110,l.nibpDia=70):o==="insuline"&&(l.targetFc=85,n="Insulinothérapie débutée",I(".val-fc",l.fc,85,2e3),l.fc=85);a.forEach(e=>{e.innerText=`[${s}] ${n}`,e.classList.add("show"),setTimeout(()=>e.classList.remove("show"),3e3)})};function I(o,a,d,s,n){const e=document.querySelectorAll(o);if(e.length===0)return;e.forEach(p=>{p.classList.add("pulse-anim"),setTimeout(()=>p.classList.remove("pulse-anim"),300)});const t=d-a;let i=a;const r=d>a?1:-1,c=Math.abs(Math.floor(s/(t===0?1:t)));if(t===0)return;const u=setInterval(function(){i+=r,e.forEach(p=>p.innerText=i),i==d&&clearInterval(u)},Math.max(c,50))}function A(o,a,d,s){const n=document.querySelectorAll(".val-nibp");if(n.length===0)return;n.forEach(r=>{r.classList.add("pulse-anim"),setTimeout(()=>r.classList.remove("pulse-anim"),300)});let e=o,t=a;const i=setInterval(()=>{let r=!1;e!=d&&(e+=e<d?1:-1,r=!0),t!=s&&e%2===0&&(t+=t<s?1:-1,r=!0),n.forEach(c=>c.innerText=`${e}/${t}`),r||clearInterval(i)},100)}function L(){const o=document.querySelectorAll(".live-monitor");if(o.length===0){setTimeout(L,500);return}o.forEach(s=>{const n=s.querySelector(".ecg-canvas"),e=s.querySelector(".pleth-canvas");if(!n||!e)return;function t(){const y=n.parentElement,m=e.parentElement,v=y.getBoundingClientRect(),w=m.getBoundingClientRect(),f=window.devicePixelRatio||1,g=v.width||y.clientWidth,h=v.height||y.clientHeight,E=w.width||m.clientWidth,b=w.height||m.clientHeight;g>0&&h>0&&(n.width=g*f,n.height=h*f,n.style.width=`${g}px`,n.style.height=`${h}px`,n.getContext("2d").scale(f,f)),E>0&&b>0&&(e.width=E*f,e.height=b*f,e.style.width=`${E}px`,e.style.height=`${b}px`,e.getContext("2d").scale(f,f))}t(),setTimeout(t,100),setTimeout(t,1e3),window.addEventListener("resize",t);const i=n.getContext("2d"),r=e.getContext("2d");let c=0,u=2;function p(){const y=parseFloat(n.style.width||n.width),m=parseFloat(n.style.height||n.height);parseFloat(e.style.width||e.width);const v=parseFloat(e.style.height||e.height),w=m/2,f=v/2,g=20;c+g<y&&(i.clearRect(c,0,g,m),r.clearRect(c,0,g,v));const h=20;i.beginPath(),i.strokeStyle="#00ff00",i.lineWidth=2;const E=w+a((c-u)*h),b=w+a(c*h);i.moveTo(c-u,E),i.lineTo(c,b),i.stroke(),r.beginPath(),r.strokeStyle="#00ffff",r.lineWidth=2;const q=f+d((c-u)*h),M=f+d(c*h);r.moveTo(c-u,q),r.lineTo(c,M),r.stroke(),c+=u,c>=y&&(c=0,i.clearRect(0,0,u+10,m),r.clearRect(0,0,u+10,v));const S=s.querySelector(".val-fc"),T=s.querySelector(".val-spo2"),P=s.querySelector(".val-nibp");S&&S.innerText!=l.fc&&(S.innerText=l.fc),T&&T.innerText!=l.spo2&&(T.innerText=l.spo2),P&&P.innerText!=`${l.nibpSys}/${l.nibpDia}`&&(P.innerText=`${l.nibpSys}/${l.nibpDia}`),requestAnimationFrame(p)}requestAnimationFrame(p)});function a(s){const e=s%800;let t=0;const i=.6;return e>180&&e<210&&(t-=90*Math.sin((e-180)/30*Math.PI)*i),e>300&&e<450&&(t-=12*Math.sin((e-300)/150*Math.PI)*i),e>50&&e<150&&(t-=4*Math.sin((e-50)/100*Math.PI)*i),t}function d(s){const e=s%800;let t=0;const i=.6;return e<300?t-=Math.sin(e/300*Math.PI)*45*i:t-=Math.cos((e-300)/500*Math.PI/2)*45*i,t}}
